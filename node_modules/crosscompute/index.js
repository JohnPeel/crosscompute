$('#arguments').keydown(function(e) {
  var $o = $(this);
  if (e.keyCode == 13) {
    if (e.shiftKey) {
      $o.find('.run').click();
    }
  }
});

$('.run').click(function() {
  var $button = $(this).prop('disabled', true),
      $form = $button.parent('form').trigger('updated.cc'),
      button_text = $button.text();
  // $form.find('.feedback').remove();
  // $form.find('.error').removeClass('error');
  $button.text('Running...');
  $.ajax({
    type: 'POST',
    url: CC.tool_json_url,
    data: $form.serialize(),
    error: function(jqXHR) {
      var d = jqXHR.responseJSON;
      /*
      for (k in d) {
        var v = d[k];
        $form.find('#' + k).parent('.form-group').addClass('error')
      }
      */
      $form.trigger('failed.cc', d);
      $button.prop('disabled', false).text(button_text);
    },
    success: function(d) {
      location.href = d.result_url;
    }
  });
});

$('[data-toggle="popover"]').popover({
  'trigger': 'click hover focus'
});
