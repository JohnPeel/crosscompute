{% extends 'page.jinja2' %}
{% from 'type.jinja2' import render_key, render_properties %}
{% set result_name = result_name or '%s (%s)' % (result_id, result_title) %}

{% block page_title %}
{% block body_subtitle %}{{ result_name }}{% endblock %} &middot; Results &middot; {{ website_name -}}
{% endblock %}

{% block head_style_inline %}
{{ super() -}}
.download {margin-top: 2em}
{% endblock %}

{% block body_content %}
{{ super() -}}
<a id="properties"></a>
{% if result_properties -%}

{% if result_errors -%}
<div class=error>
{{ render_properties(result_errors) -}}
</div>
{% else -%}

{% for x in result_template_parts %}
{%- if x is string -%}
{{ x | markdown }}

{%- else -%}
{% from x.data_type.template import render_property %}
{{- render_key(x) }}
{{- render_property(x) -}}

{%- endif -%}
{% endfor -%}

{% endif -%}

{{- render_properties(result_properties) -}}

<a href="{{ request.route_path('result.zip', id=result_id, name=result_name) }}" class="btn btn-success download" role="button" download>Download</a>
{% endif %}
{% endblock %}
